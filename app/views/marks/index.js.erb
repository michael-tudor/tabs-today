(function () {
  var grid = jQuery('.grid-stack').data('gridstack');
  <% if @marks.present? %>
    <% @marks.each do |mark| %>
      <% ps = @positions_and_sizes.find { |p| p['id'] == mark.id.to_s } %>
      <% ps = {'x' => 4, 'y' => 2, 'w' => 4, 'h' => 4} unless ps.present? %>
      grid.addWidget(
        jQuery("<%= j render partial: 'form', locals: { mark: mark } %>"),
        <%= ps['x'] %>, <%= ps['y'] %>, <%= ps['w'] %>, <%= ps['h'] %>);
    <% end %>
  <% elsif @mark.present? %>
    grid.addWidget(jQuery("<%= j render partial: 'form', locals: { mark: @mark } %>"), 4, 2, 4, 4);
  <% end %>
})();
